cmake_minimum_required(VERSION 4.0)
project(llvm2mc)

set(CMAKE_CXX_STANDARD 20)

find_package(LLVM REQUIRED CONFIG)

message(STATUS "Found LLVM ${LLVM_PACKAGE_VERSION}")
message(STATUS "LLVM include dirs: ${LLVM_INCLUDE_DIRS}")

file(GLOB_RECURSE SRC_FILES src/*.cpp src/*.h)

add_executable(llvm2mc ${SRC_FILES})
target_include_directories(llvm2mc PRIVATE ${LLVM_INCLUDE_DIRS})
target_link_libraries(llvm2mc PRIVATE LLVMCore LLVMBitReader LLVMIRReader)

install(TARGETS llvm2mc
        RUNTIME DESTINATION bin
)

install(DIRECTORY include/
        DESTINATION include/llvm2mc
        FILES_MATCHING PATTERN "*.h"
)
